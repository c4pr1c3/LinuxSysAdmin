<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="黄玮">
  <title>Linux系统与网络管理</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="reveal.js/css/reveal.css">
  <style type="text/css">code{white-space: pre;}</style>


    <!-- For syntax highlighting using highlight.js-->
    <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">
  <!-- Printing and PDF exports -->
<link rel="stylesheet" media="print" href="reveal.js/css/print/pdf.css" />
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="reveal.js/lib/js/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Linux系统与网络管理</h1>
  <p class="author">黄玮</p>
</section>

<section>
<section id="第二章linux服务器系统使用基础"
class="title-slide slide level1">
<h1>第二章：Linux服务器系统使用基础</h1>

</section>
<section id="from-gui-to-cli" class="slide level2">
<h2>From GUI to CLI</h2>
<p><img data-src="images/chap0x02/sl.gif" /></p>
</section></section>
<section>
<section id="软件包管理" class="title-slide slide level1">
<h1>软件包管理</h1>

</section>
<section id="提纲" class="slide level2">
<h2>提纲</h2>
<ul>
<li>sources.list格式</li>
<li>小心添加第三方软件源</li>
<li>查找：apt-get update &amp;&amp; apt-cache
search、apt-file、google、dpkg -S、aptitude</li>
<li>安装：软件被装到哪里去了</li>
<li>升级：区分upgrade与dist-upgrade</li>
<li>卸载：purge、clean、remove</li>
<li>源码下载与安装
<ul>
<li>README.md / INSTALL</li>
</ul></li>
</ul>
</section>
<section id="ubuntu-16.04-vs-20.04-etcaptsources.list"
class="slide level2">
<h2>Ubuntu 16.04 vs 20.04 /etc/apt/sources.list</h2>
<p><img
data-src="images/chap0x02/vimdiff-16vs20.sources.list.png" /></p>
</section>
<section id="sources.list-格式说明" class="slide level2">
<h2>sources.list 格式说明</h2>
<pre class="bash"><code>man sources.list</code></pre>
<ul>
<li>xenial 是 Ubuntu 16.04 的<a
href="https://en.wikipedia.org/wiki/Ubuntu_version_history">官方版本代号</a></li>
<li>focal 是 Ubuntu 20.04 的<a
href="https://en.wikipedia.org/wiki/Ubuntu_version_history">官方版本代号</a></li>
</ul>
</section>
<section id="soft-type-codename-1" class="slide level2">
<h2><a
href="https://help.ubuntu.com/community/Repositories/Ubuntu">软件包类型代号</a></h2>
<ul>
<li>Main - Canonical官方支持的免费和开源软件</li>
<li>Universe - （开源）社区维护的免费和开源软件</li>
<li>Restricted - 私有设备驱动</li>
<li>Multiverse - 有版权限制的私有软件</li>
</ul>
<p>以下是<a
href="https://en.wikipedia.org/wiki/Ubuntu_%28operating_system%29#Package_classification_and_support">Wikipedia的软件包分类和支持分类说明</a></p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;">免费软件</th>
<th style="text-align: left;">非免费软件</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">官方支持</td>
<td style="text-align: left;">main</td>
<td style="text-align: left;">restricted</td>
</tr>
<tr>
<td style="text-align: left;">官方不支持（社区或第三方支持）</td>
<td style="text-align: left;">universe</td>
<td style="text-align: left;">multiverse</td>
</tr>
</tbody>
</table>
</section>
<section id="soft-type-codename-2" class="slide level2">
<h2><a
href="https://help.ubuntu.com/community/Repositories/Ubuntu">软件包类型代号</a></h2>
<ul>
<li><a
href="https://help.ubuntu.com/community/UbuntuBackports">backports</a>
<ul>
<li>官方安全审查小组 <strong>不会</strong> 提供任何
<code>安全审查和安全性承诺保障</code></li>
<li>向旧版本系统提供较新且兼容旧版系统和所有依赖关系的软件</li>
</ul></li>
<li><a
href="https://help.ubuntu.com/community/Repositories/Ubuntu#Enabling_Canonical_Partner_Repositories">partner</a>
<ul>
<li>非Ubuntu系统的必要组件，是Canonical公司及其合作伙伴向Ubuntu用户提供的附加软件：通常是闭源和商业版权软件</li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<h3 id="举例讲解">举例讲解</h3>
<pre class="ini"><code>deb http://cn.archive.ubuntu.com/ubuntu/ xenial multiverse</code></pre>
<p><strong>apt-get
update</strong>的过程是访问一个构造好的URL，该URL使用内置的字符串“拼接”规则构造成</p>
<pre class="ini"><code>http://cn.archive.ubuntu.com/ubuntu/dists/xenial/multiverse/binary-amd64/</code></pre>
<ul>
<li>其中 <strong>binary-amd64</strong>
是根据当前系统是64位而“换算”得来的，如果是32位系统该位置字符串会被替换为
<strong>binary-i386</strong></li>
<li>当前发行版版本代号后面有不止一个软件包类型代号时，有几个软件包类型代号就对应会构造出几个实际的软件列表下载地址</li>
</ul>
</section>
<section id="ports.ubuntu.com" class="slide level2">
<h2>ports.ubuntu.com</h2>
<ul>
<li><a
href="https://www.yuque.com/c4pr1c3/linux/ttkz7y#comment-9934732">无人值守安装时卡住很久？</a>
<ul>
<li><a
href="https://wiki.ubuntu.com/UbuntuDevelopment/PackageArchive">软件源
http://ports.ubuntu.com 收录的架构为 arm64，armhf，PowerPC，ppc64el
等</a></li>
<li>软件源 http://cn.archive.ubuntu.com 收录的架构为 amd64 和 i386</li>
</ul></li>
<li>Ubuntu 官方支持的技术架构：amd64, armhf, i386</li>
</ul>
</section>
<section class="slide level2">

<h3 id="验证-ports.ubuntu.com-访问">验证 ports.ubuntu.com 访问</h3>
<p><a href="https://tools.ipip.net/newping.php"><img
data-src="images/chap0x02/ipip.net.ping.test.png" /></a></p>
</section>
<section class="slide level2">

<h3 id="解决-ports.ubuntu.com-导致的无人值守安装卡住问题">解决
ports.ubuntu.com 导致的无人值守安装卡住问题</h3>
<ul>
<li>删除 <code>ports.ubuntu.com</code> 相关的 2 行配置代码</li>
<li>搜索 <code>ports.ubuntu.com 中国镜像</code>
进行镜像源地址修改，推荐阿里云、中科大、清华的镜像源</li>
</ul>
</section>
<section class="slide level2">

<p><strong>apt-get update</strong> VS. <strong>apt-get upgrade</strong>
VS. <strong>apt-get dist-upgrade</strong></p>
<pre class="bash"><code>man apt-get</code></pre>
<ul>
<li><strong>apt-get update</strong>
使用/etc/apt/sources.list中定义的镜像源地址更新可用软件包列表，更新本地的可用软件包信息数据库文件，并不会“安装”或“更新”任何软件</li>
<li><strong>apt-get upgrade</strong>
根据本地的可用软件包信息数据库文件内容更新安装当前系统中所有已安装软件的版本</li>
<li><strong>apt-get dist-upgrade</strong> 在<strong>apt-get
upgrade</strong>的基础上可以解决部分软件升级时需要卸载其他软件的自动依赖关系推导和解决问题，通常内核版本升级都需要通过该命令来实现</li>
</ul>
</section>
<section class="slide level2">

<p><strong>apt-get remove</strong> VS. <strong>apt-get purge</strong>
VS. <strong>apt-get clean</strong></p>
<ul>
<li><strong>apt-get remove</strong>
删除已安装软件包但不删除配置文件</li>
<li><strong>apt-get purge</strong> 删除已安装软件包和配置文件</li>
<li><strong>apt-get clean</strong>
删除/var/cache/apt/archives/和/var/cache/apt/archives/partial/目录下除了lock文件之外的所有已下载（软件包）文件</li>
</ul>
</section>
<section class="slide level2">

<p><strong>apt-get autoclean</strong> VS. <strong>apt-get
autoremove</strong></p>
<ul>
<li><strong>apt-get autoclean</strong> 和<strong>apt-get
clean</strong>类似，但更“智能”，主要是为了清除无用缓存保留可能还有用的缓存用的</li>
<li><strong>apt-get autoremove</strong>
删除所有用于满足其他软件依赖关系而自动安装但现在已经没有软件依赖的软件包</li>
</ul>
</section>
<section id="查找你需要的软件包-如果你知道软件包名"
class="slide level2">
<h2>查找你需要的软件包 —— 如果你知道软件包名</h2>
<pre class="bash"><code>apt-get install &lt;package_name&gt;</code></pre>
</section>
<section id="查找你需要的软件包-如果你知道软件名但不知道软件包名"
class="slide level2">
<h2>查找你需要的软件包 —— 如果你知道软件名，但不知道软件包名</h2>
<pre class="bash"><code>apt-cache search &lt;software_keyword&gt;
apt-get install &lt;software_keyword&gt;&lt;TAB&gt;&lt;TAB&gt;

# example
apt-cache search mysql
apt-cache search apache

# 利用终端的自动补全机制获得以mysql关键字开头的所有软件包名
apt-get install mysql&lt;TAB&gt;&lt;TAB&gt;</code></pre>
<ul>
<li>Google Knows!!!</li>
</ul>
</section>
<section class="slide level2">

<p>apt-file - APT package searching utility – command-line interface</p>
<pre class="bash"><code>apt-get install apt-file
man apt-file</code></pre>
<blockquote>
<p>apt-file is a command line tool for searching files in packages for
the APT package management system.</p>
</blockquote>
</section>
<section class="slide level2">

<p>aptitude -
对<strong>apt-get</strong>进行封装的一个更友好、更易用（主要体现在自动解决软件依赖bug上）包管理工具</p>
<pre class="bash"><code>apt-get install aptitude
man aptitude</code></pre>
<pre class="bash"><code>$ aptitude show mysql-server
Package: mysql-server
State: not installed
Version: 5.7.16-0ubuntu0.16.04.1
Priority: optional
Section: database
Maintainer: Ubuntu Developers &lt;ubuntu-devel-discuss@lists.ubuntu.com&gt;
Architecture: all
Uncompressed Size: 106 k
Depends: mysql-server-5.7
Provided by: percona-server-server-5.6 (5.6.22-rel71.0-0ubuntu4), percona-server-server-5.6
             (5.6.22-rel71.0-0ubuntu4.1), percona-xtradb-cluster-server-5.6 (5.6.21-25.8-0ubuntu3),
             percona-xtradb-cluster-server-5.6 (5.6.21-25.8-0ubuntu3.2)
Description: MySQL database server (metapackage depending on the latest version)
 This is an empty package that depends on the current &quot;best&quot; version of mysql-server (currently
 mysql-server-5.7), as determined by the MySQL maintainers. Install this package if in doubt about which
 MySQL version you need. That will install the version recommended by the package maintainers.

 MySQL is a fast, stable and true multi-user, multi-threaded SQL database server. SQL (Structured Query
 Language) is the most popular database query language in the world. The main goals of MySQL are speed,
 robustness and ease of use.
Homepage: http://dev.mysql.com/

$ aptitude show aptitude
Package: aptitude
State: installed
Automatically installed: no
Multi-Arch: foreign
Version: 0.7.4-2ubuntu2
Priority: optional
Section: admin
Maintainer: Ubuntu Developers &lt;ubuntu-devel-discuss@lists.ubuntu.com&gt;
Architecture: amd64
Uncompressed Size: 4,205 k
Depends: aptitude-common (= 0.7.4-2ubuntu2), libapt-pkg5.0 (&gt;= 1.1), libboost-iostreams1.58.0, libc6 (&gt;=
         2.14), libcwidget3v5, libgcc1 (&gt;= 1:3.0), libncursesw5 (&gt;= 6), libsigc++-2.0-0v5 (&gt;= 2.6.1),
         libsqlite3-0 (&gt;= 3.6.5), libstdc++6 (&gt;= 5.2), libtinfo5 (&gt;= 6), libxapian22v5
Recommends: libparse-debianchangelog-perl, sensible-utils
Suggests: apt-xapian-index, aptitude-doc-en | aptitude-doc, debtags, tasksel
Conflicts: aptitude:i386
Provides: aptitude:i386 (= 0.7.4-2ubuntu2)
Provided by: aptitude:i386 (0.7.4-2ubuntu2)
Description: terminal-based package manager
 aptitude is a package manager with a number of useful features, including: a mutt-like syntax for matching
 packages in a flexible manner, dselect-like persistence of user actions, the ability to retrieve and
 display the Debian changelog of most packages, and a command-line mode similar to that of apt-get.

 aptitude is also Y2K-compliant, non-fattening, naturally cleansing, and housebroken.
Homepage: http://aptitude.alioth.debian.org/</code></pre>
</section>
<section id="aptitude-apt-get-apt" class="slide level2">
<h2>aptitude, apt-get, apt</h2>
<p>整理自：<a
href="https://debian-handbook.info/browse/stable/sect.apt-get.html">The
Debian Administrator’s Handbook</a></p>
<ul>
<li>CLI: <code>apt-get</code> 诞生最早；<code>apt</code> 稍晚，改进了
<code>apt-get</code> 的一些设计缺陷，更简单易用，推荐优先使用</li>
<li>GUI: <code>synaptic</code>, <code>aptitude</code>（也有 CLI
接口）</li>
</ul>
</section>
<section id="在安装前如何确认软件包的版本来源" class="slide level2">
<h2>在安装前如何确认软件包的版本、来源</h2>
<pre class="bash"><code># apt-cache policy &lt;package-name&gt;
# apt policy &lt;package-name&gt;
apt-cache policy mysql-server

mysql-server:
  Installed: (none)
  Candidate: 5.7.21-0ubuntu0.16.04.1
  Version table:
     5.7.21-0ubuntu0.16.04.1 500
        500 http://cn.archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages
        500 http://cn.archive.ubuntu.com/ubuntu xenial-updates/main i386 Packages
        500 http://security.ubuntu.com/ubuntu xenial-security/main amd64 Packages
        500 http://security.ubuntu.com/ubuntu xenial-security/main i386 Packages
     5.7.11-0ubuntu6 500
        500 http://cn.archive.ubuntu.com/ubuntu xenial/main amd64 Packages
        500 http://cn.archive.ubuntu.com/ubuntu xenial/main i386 Packages</code></pre>
</section>
<section id="安装指定版本的软件" class="slide level2">
<h2>安装指定版本的软件</h2>
<pre class="bash"><code># 根据 apt-cache policy 输出结果里当前软件包的所有候选版本号
# apt install &lt;package&gt;=&lt;version&gt;
# 默认总是安装最新版
sudo apt install mysql-server=5.7.11-0ubuntu6</code></pre>
</section>
<section id="软件被装到哪里去了" class="slide level2">
<h2>软件被装到哪里去了</h2>
<pre class="bash"><code># 查找apache2软件包依赖哪些独立软件包（名）
$ apt-cache depends apache2

# 查看指定软件包（名）在系统上创建了哪些目录和文件
$ dpkg -L apache2

# 由于apt-get在安装一款软件包时会自动安装相关依赖的软件包
# 所以，通常还需要查看这些被自动依赖安装的软件包又在系统上创建了哪些目录和文件
$ dpkg -L apache2-data
$ dpkg -L apache2-bin</code></pre>
</section>
<section class="slide level2">

<p>谨慎修改<strong><em>/etc/apt/sources.list</em></strong>和在<strong><em>/etc/apt/sources.list.d/</em></strong>下创建第三方镜像配置文件!!!</p>
<p>谨慎修改<strong><em>/etc/apt/sources.list</em></strong>和在<strong><em>/etc/apt/sources.list.d/</em></strong>下创建第三方镜像配置文件!!!</p>
<p>谨慎修改<strong><em>/etc/apt/sources.list</em></strong>和在<strong><em>/etc/apt/sources.list.d/</em></strong>下创建第三方镜像配置文件!!!</p>
</section>
<section id="使用第三方镜像源的风险" class="slide level2">
<h2>使用第三方镜像源的风险</h2>
<ul>
<li><a
href="http://weibo.com/1651460060/A4L8xoRZQ">发行版不匹配、发行版匹配但版本代号不匹配导致大量软件依赖关系出现错乱，无法修复、无法删除、无法安装软件</a>
<ul>
<li>最大可能是：只能重装系统解决</li>
</ul></li>
<li><a
href="http://weibo.com/1651460060/BrdV8lYYK">第三方镜像源的软件篡改留后门、中间人劫持风险</a></li>
</ul>
</section>
<section id="deb软件包管理工具-dpkg" class="slide level2">
<h2>DEB软件包管理工具 —— dpkg</h2>
<pre class="bash"><code>man dpkg</code></pre>
<pre><code>$ dpkg --help
Usage: dpkg [&lt;option&gt; ...] &lt;command&gt;

Commands:
  -i|--install       &lt;.deb file name&gt; ... | -R|--recursive &lt;directory&gt; ...
  -s|--status &lt;package&gt; ...        Display package status details.
  -p|--print-avail &lt;package&gt; ...   Display available version details.
  -L|--listfiles &lt;package&gt; ...     List files &#39;owned&#39; by package(s).
  -l|--list [&lt;pattern&gt; ...]        List packages concisely.
  -S|--search &lt;pattern&gt; ...        Find package(s) owning file(s).</code></pre>
</section>
<section id="使用源代码方式编译安装" class="slide level2">
<h2>使用源代码方式（编译）安装</h2>
<ul>
<li>优先使用包管理器apt-get方式安装软件，避免使用源代码方式（编译）安装
<ul>
<li>python软件优先使用pip，ruby软件优先使用gem，php软件优先使用composer，nodejs软件优先使用npm，perl软件优先使用cpanm</li>
</ul></li>
<li>推荐使用源代码下载来源
<ul>
<li><strong>apt-get source pkg</strong></li>
<li>软件作者托管在github上的代码</li>
</ul></li>
<li>动手操作之前一定要看README、INSTALL等说明文档</li>
<li>确保本地编译环境满足源代码安装的所有依赖条件</li>
<li>安装失败一定要仔细核对出错信息、出错日志，在Google中根据错误代码、错误关键字搜索解决方案</li>
</ul>
</section></section>
<section>
<section id="文件管理基本命令" class="title-slide slide level1">
<h1>文件管理基本命令</h1>

</section>
<section class="slide level2">

<ul>
<li>ls</li>
<li>touch</li>
<li>rm / shred</li>
<li>ln</li>
<li>find</li>
<li>grep</li>
</ul>
</section>
<section id="文件管理" class="slide level2">
<h2>文件管理</h2>
<ul>
<li>扩展名查找</li>
<li>通配符匹配</li>
<li>按文件大小</li>
<li>按文件更新时间早于、晚于、在日期之间</li>
<li>查找到匹配后执行
<ul>
<li><code>find ... -execdir xxx {} \</code>;</li>
</ul></li>
</ul>
</section>
<section id="文本内容检索" class="slide level2">
<h2>文本内容检索</h2>
<ul>
<li>grep -i</li>
<li>grep -A</li>
<li>grep -c</li>
<li>grep -E</li>
<li>grep -v</li>
</ul>
</section></section>
<section>
<section id="管道-pipe" class="title-slide slide level1">
<h1>管道 Pipe</h1>

</section>
<section class="slide level2">

<blockquote>
<p>回顾「第一章」实验中用到的这个命令里使用的操作符：|</p>
</blockquote>
<pre class="bash"><code>cd ~/cd &amp;&amp; find . -type f -print0 | xargs -0 md5sum &gt; md5sum.txt</code></pre>
</section>
<section class="slide level2">

<p>上一页的例子中</p>
<ul>
<li><code>-print0</code> 将标准输出中的多条记录使用
<strong>NULL</strong>（<code>\00</code>）字符拼接成一个「长字符串」一次性输出到「标准输出」</li>
<li>如果不使用 <code>xargs</code> 命令，<code>md5sum</code>
将把「管道操作符」左侧命令的「标准输出」当作自己的「标准输入」计算 MD5
散列值</li>
<li><code>xargs</code> 的 <code>-0</code> 参数将「标准输入」中的
<strong>NULL</strong> 字符视为「数组分隔符」来「解析」标准输入内容</li>
<li><code>xargs</code>
从「标准输入」中每解析出「一个参数」就按照构造好的
<code>命令+参数</code> 执行一次指定的命令（此处是
<code>md5sum [fileN]</code> ），直到「标准输入」被解析完毕</li>
</ul>
</section>
<section class="slide level2">

<p><a
href="https://explainshell.com/explain?cmd=cd+%7E%2Fcd+%26%26+find+.+-type+f+-print0+%7C+xargs+-0+md5sum+%3E+md5sum.txt">explainshell.com
对上述复杂命令的可视化解读</a></p>
</section></section>
<section>
<section id="sed" class="title-slide slide level1">
<h1>sed</h1>

</section>
<section class="slide level2">

<p>SED的英文全称是<strong>Stream
EDitor</strong>，它是一个简单而强大的文本解析转换工具，在1973-1974年期间由贝尔实验室的<strong><em>Lee
E. McMahon</em></strong>开发。</p>
<p><strong><em>McMahon</em></strong>创建了一个通用的行编辑器，最终变成为了SED。SED的很多语法和特性都借鉴了ed编辑器。设计之初，它就已经支持正则表达式，SED可以从文件中接受类似于管道的输入，也可以接受来自标准输入流的输入。</p>
<p>SED由自由软件基金组织（FSF）开发和维护并且随着GNU/Linux进行分发，因此，通常它也称作<strong><em>GNU
SED</em></strong>。</p>
</section>
<section id="sed-典型用途" class="slide level2">
<h2>SED 典型用途</h2>
<ul>
<li>文本替换</li>
<li>选择性的输出文本文件</li>
<li>从文本文件的某处开始编辑</li>
<li>无交互式的对文本文件进行编辑等</li>
</ul>
</section>
<section id="sed-quick-reference" class="slide level2">
<h2>SED Quick Reference</h2>
</section>
<section class="slide level2">

<ul>
<li><a
href="http://www.ituring.com.cn/article/273760">三十分钟学会SED</a></li>
<li><a
href="https://www.google.com/#newwindow=1&amp;q=sed+%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE">Google:
sed思维导图</a></li>
<li><a
href="http://sed.sourceforge.net/sed1line_zh-CN.html">sed单行常用脚本</a></li>
</ul>
</section>
<section id="学习-sed-的模式" class="slide level2">
<h2>学习 SED 的模式</h2>
<ul>
<li>REPL: read–eval–print loop</li>
</ul>
</section></section>
<section>
<section id="正则表达式" class="title-slide slide level1">
<h1>正则表达式</h1>

</section>
<section class="slide level2">

<blockquote>
<p>正则表达式是用于匹配字符串中字符组合的 <strong>模式</strong>
，可以用来检查一个串是否 <strong>包含</strong> 有某种子串、将匹配的子串
<strong>替换</strong> 或者从某个串中 <strong>取出</strong>
符合某个条件的子串等。</p>
</blockquote>
</section>
<section id="在线正则表达式调试工具" class="slide level2">
<h2>在线正则表达式调试工具</h2>
<p><code>regular expression tester</code></p>
<blockquote>
<p>不同编程语言对正则表达式的支持存在细微差异</p>
</blockquote>
</section>
<section id="regexp-cli-tools" class="slide level2">
<h2>Linux 命令行工具对正则表达式的支持</h2>
<pre class="bash"><code>sed
# -E, -r, --regexp-extended
#               use extended regular expressions in the script (for portability use POSIX -E)

awk
# man awk

grep
# -E, --extended-regexp
#               Interpret PATTERNS as extended regular expressions (EREs, see below).
# -G, --basic-regexp
#        Interpret PATTERNS as basic regular expressions (BREs, see below).  This is the default.
# -P, --perl-regexp
#        Interpret PATTERNS as Perl-compatible regular expressions (PCREs).  This option is experimental when combined
#        with the -z (--null-data) option, and grep -P may warn of unimplemented features.</code></pre>
</section>
<section class="slide level2">

<p><a href="images/chap0x02/davechild_regular-expressions.bw.jpg"><img
data-src="images/chap0x02/davechild_regular-expressions.bw.jpg" /></a></p>
</section></section>
<section>
<section id="社区驱动的脱水版帮助手册" class="title-slide slide level1">
<h1>社区驱动的「脱水版」帮助手册</h1>

</section>
<section class="slide level2">

<p><a href="https://github.com/tldr-pages/tldr">tldr: To Long, Don’t
Read</a></p>
<blockquote>
<p>跟着「范例」学命令</p>
</blockquote>
</section>
<section class="slide level2">

<p><img data-src="images/chap0x02/TLDR-example.png" /></p>
</section>
<section id="快速安装与上手使用" class="slide level2">
<h2>快速安装与上手使用</h2>
<pre class="bash"><code>sudo apt update &amp;&amp; sudo apt install tldr
# 从自建 gitee 镜像下载 tldr 所有手册页
git clone https://gitee.com/c4pr1c3/tldr ~/.tldr/cache

# 如果需要查看中文帮助信息
# ⚠️ 警告⚠️ 很多手册页并没有中文翻译版
# 以下方法切换默认查询目录后会导致很多命令查询失败
## 确保进入正确目录
cd $HOME/.tldr/cache

## 确认当前目录下不存在 pages.en 目录
ls pages.en
# ls: cannot access &#39;pages.en&#39;: No such file or directory

## 备份默认英文帮助子目录
mv pages pages.en

## 将中文帮助目录设置为默认查询帮助信息目录
ln -s pages.zh pages

# 恢复默认英文查询手册页设置
rm pages
ln -s pages.en pages</code></pre>
</section></section>
<section>
<section id="文本内容查找替换神器之awk"
class="title-slide slide level1">
<h1>文本内容查找替换神器之AWK</h1>

</section>
<section class="slide level2">

<ul>
<li><a href="http://www.pement.org/awk/awk1line.txt">HANDY ONE-LINE
SCRIPTS FOR AWK</a></li>
</ul>
</section></section>
<section>
<section id="其他文本内容处理小工具" class="title-slide slide level1">
<h1>其他文本内容处理小工具</h1>

</section>
<section class="slide level2">

<ul>
<li>head / tail
<ul>
<li>服务器上监视日志持续变化 <code>tail -F</code></li>
</ul></li>
<li>cut
<ul>
<li><code>cut -d ":" -f 1,6 /etc/passwd</code></li>
</ul></li>
<li>tr
<ul>
<li><code>echo "hello world" | tr [:lower:] [:upper:]</code></li>
<li><code>echo "hello world" | tr -d hello</code></li>
</ul></li>
</ul>
</section></section>
<section>
<section id="一些文本处理的任务" class="title-slide slide level1">
<h1>一些文本处理的任务</h1>

</section>
<section id="学会使用搜索引擎" class="slide level2">
<h2>学会使用搜索引擎</h2>
<ul>
<li>查找并统计某函数在整个“项目”中被调用次数，并输出在哪些文件、具体那些行中调用到了该函数</li>
<li>在整个目录中查找某关键词出现在哪些文件的哪些行</li>
<li>删除C语言编写项目中的所有注释行</li>
</ul>
</section></section>
<section>
<section id="别名机制---alias" class="title-slide slide level1">
<h1>别名机制 - alias</h1>

</section>
<section class="slide level2">

<pre class="bash"><code># 查看当前shell环境中已定义的别名有哪些
alias
# 注意alias不是一个外部命令（文件），而是bash的一个内置函数
man alias
# 在bash的手册页中去搜索alias
man bash</code></pre>
</section></section>
<section>
<section id="文件压缩与解压缩" class="title-slide slide level1">
<h1><a
href="https://www.cyberciti.biz/howto/question/general/compress-file-unix-linux-cheat-sheet.php">文件压缩与解压缩</a></h1>

</section>
<section class="slide level2">

<ul>
<li>gzip</li>
<li>bzip2</li>
<li>zip</li>
<li><strong><em>tar</em></strong></li>
<li>7z (p7zip)</li>
<li>rar (p7zip-rar / unrar-free)
<ul>
<li>rar是私有压缩算法格式，Linux平台只支持解压缩</li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<p><a href="https://www.zhihu.com/question/20523036">Linux 下 zip
文件解压乱码如何解决？</a></p>
<p><a href="https://asciinema.org/a/d81fdjlf83ecltrpewh4tg4hj" target="_blank"><img src="images/chap0x02/d81fdjlf83ecltrpewh4tg4hj.png" /></a></p>
</section></section>
<section>
<section id="进程管理" class="title-slide slide level1">
<h1>进程管理</h1>

</section>
<section class="slide level2">

<ul>
<li>ps aux</li>
<li>pstree</li>
<li>pidof</li>
<li>top
<ul>
<li>运行时性能分析利器</li>
</ul></li>
<li>htop
<ul>
<li>改进的交互式系统信息查看器</li>
</ul></li>
<li>kill / kill -9 / kill -s N / killall
<code>&lt;process_imagename&gt;</code></li>
</ul>
</section>
<section id="子进程管理" class="slide level2">
<h2>子进程管理</h2>
<ul>
<li>将进程放到“后台”运行： &amp;</li>
<li>Bash内置的2个进程管理函数：bg / fg</li>
</ul>
<pre class="bash"><code># 执行以下ping命令后终端所有操作被“无视忽略掉”
ping www.baidu.com
# 直到使用CTRL-C快捷键组合输入，可以终止该ping进程
CTRL-C
# 我们试着把ping进程放到“后台”执行
ping www.baidu.com &amp;
# 此时终端不断被“涌出”的ping输出结果“污染”
# 此时CTRL-C无效
CTRL-C
# 以下“2连击”可以终止该ping进程
fg
CTRL-C
# 我们再试着把ping进程放到“后台”执行，这一次我们把标准错误输出先重定向到标准输出，然后再把标准输出重定向到“黑洞”文件
ping www.baidu.com 1&gt;/dev/null 2&gt;&amp;1 &amp;
# 整个世界都清净了，终端不会再被“涌出”的ping输出结果“污染”
# 查看进程会发现ping在“后台”一直运行着
ps aux | grep ping
ping www.cuc.edu.cn 1&gt;/dev/null 2&gt;&amp;1 &amp;
# 杀死所有ping进程
killall ping</code></pre>
</section>
<section id="子进程管理实验live-demo" class="slide level2">
<h2>子进程管理实验Live Demo</h2>
<ul>
<li>注意CTRL-Z的作用，被CTRL-Z的进程在<strong><em>ps
aux</em></strong>中的进程状态如何显示的</li>
</ul>
<p><a href="https://asciinema.org/a/f3ux5ogwbxwo2q0wxxd0hmn54" target="_blank"><img src="images/chap0x02/asciinema_demo_1.png" alt="子进程管理Demo"/></a></p>
</section>
<section id="关于输出重定向" class="slide level2">
<h2>关于输出重定向</h2>
<pre class="bash"><code>man bash
# search &quot;Redirecting Standard Output and Standard Error&quot;</code></pre>
</section></section>
<section>
<section id="目录管理" class="title-slide slide level1">
<h1>目录管理</h1>

</section>
<section class="slide level2">

<ul>
<li>man hier</li>
<li>ls</li>
<li>mkdir / mkdir -p</li>
<li>rm -rf、 rmdir</li>
<li><code>~</code> / . / .. / -</li>
<li>/proc</li>
</ul>
</section></section>
<section>
<section id="环境变量" class="title-slide slide level1">
<h1>环境变量</h1>

</section>
<section class="slide level2">

<ul>
<li><code>$PATH</code></li>
<li><code>$HOME</code>、<code>$PWD</code></li>
<li>/etc/profile</li>
<li><code>~/.bashrc、~/.profile</code></li>
</ul>
</section></section>
<section>
<section id="网络调试" class="title-slide slide level1">
<h1>网络调试</h1>

</section>
<section class="slide level2">

<ul>
<li>ip</li>
<li>lsof</li>
<li><del>
arp
</del></li>
<li><del>
ifconfig
</del></li>
<li><del>
route
</del></li>
<li><del>
netstat
</del></li>
</ul>
</section>
<section id="网络调试常见第三方工具" class="slide level2">
<h2>网络调试常见第三方工具</h2>
<ul>
<li>ethtool</li>
<li>dstat</li>
<li>mtr</li>
<li>traceroute</li>
<li>tcpdump</li>
</ul>
</section>
<section id="相关重要配置文件" class="slide level2">
<h2>相关重要配置文件</h2>
<ul>
<li>/etc/hosts</li>
<li>/etc/resolv.conf</li>
<li>/etc/network/interfaces</li>
<li>/etc/network/if-up.d、if-post-down.d、if-pre-up.d、if-down.d</li>
</ul>
</section></section>
<section>
<section id="提问的智慧---描述你的环境"
class="title-slide slide level1">
<h1>提问的智慧 - 描述你的环境</h1>

</section>
<section class="slide level2">

<p>自己回答以下问题（软件相关）</p>
<ul>
<li>操作系统发行版和内核信息</li>
<li>系统中当前有谁在线</li>
<li>现在在运行的进程有哪些</li>
<li>哪些进程在监听哪些端口</li>
<li>挂载点和文件系统</li>
<li>已安装应用软件列表、故障或问题发生前最近新安装的软件信息</li>
<li>系统环境变量、当前用户环境变量</li>
</ul>
</section>
<section class="slide level2">

<p>自己回答以下问题（软件相关进阶问题）</p>
<ul>
<li>故障/问题发生前后邻近的系统日志、应用程序日志等</li>
<li>系统自启动项有哪些，自启动机制分别是什么；系统定时任务有哪些，触发机制分别是什么</li>
<li>出问题应用程序的当前环境变量设置情况等</li>
<li>当前系统中哪些应用程序/进程在占用网络带宽？</li>
</ul>
</section>
<section class="slide level2">

<p>自己回答以下问题（软件相关高级问题）</p>
<p>如果能初步判断出问题的关联应用程序，那么首先建议阅读应用程序官方的bug报告指南，然后尽力去收集：</p>
<ul>
<li>疑似出问题应用程序的
<ul>
<li>版本信息、编译方式、安装方式等</li>
<li>已加载第三方模块信息、依赖的第三方lib版本信息</li>
<li>完整或能复现问题的最小化配置文件</li>
<li>调试模式的运行、启动日志</li>
<li>第三方性能分析、调试工具的分析、调试日志</li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<p>自己回答以下问题（网络相关）</p>
<ul>
<li>系统的IP地址、MAC地址信息</li>
<li>ARP表 / 路由表 / hosts文件配置 / DNS服务器配置 / 代理服务器配置</li>
<li>防火墙规则表</li>
</ul>
</section>
<section class="slide level2">

<p>自己回答以下问题（硬件相关）</p>
<ul>
<li>硬件品牌、型号、购买渠道等</li>
<li>CPU/内存/硬盘/网卡/外设和主要接口等硬件参数信息（例如是否使用了RAID？）</li>
<li>联网信息，例如使用的宽带接入方式、上下行带宽、运营商信息等</li>
</ul>
</section>
<section id="提问的智慧---使用自动化的工具描述你的环境"
class="slide level2">
<h2>提问的智慧 - 使用自动化的工具描述你的环境</h2>
<pre class="bash"><code># 获得硬件信息
report-hw

# reportbug 需要另行安装

reportbug
# *** ERROR: &quot;Ubuntu&quot; BTS is currently unsupported. Please use &quot;ubuntu-bug&quot; (from the apport package) for reporting bugs in Ubuntu. You can report bugs to Debian by
# specifying &#39;bts debian&#39; in your ~/.reportbugrc or by passing the -B debian option on the commandline (see reportbug(1)).

reportbug --template --bts debian -S normal vim

# 将指定软件的相关信息保存到本地而不是直接提交给软件作者
sudo ubuntu-bug openssh-server --save openssh-server.bug</code></pre>
</section>
<section class="slide level2">

<ul>
<li>目标应用程序官方提供的故障诊断工具运行日志</li>
<li><a href="https://nicolargo.github.io/glances/">An Eye on your
system</a></li>
</ul>
</section></section>
<section>
<section id="面向大模型的提示词工程技巧"
class="title-slide slide level1">
<h1>面向大模型的提示词工程技巧</h1>

</section>
<section id="prompt-engineering-1" class="slide level2">
<h2>六要素模型 (1/2)</h2>
<ol type="1">
<li><strong>指令</strong>
。明确任务的目的和要求，使用清晰、准确、简洁的语言表达。
<ul>
<li><strong>细化</strong>
。将复杂的任务拆分为更简单的子任务，使用分隔符或列表等方式清晰地划分不同的文本部分。</li>
<li><strong>强调</strong>
。使用强调词或强调符号，突出重要的需求或约束。</li>
</ul></li>
<li><strong>上下文</strong>
。提供与任务相关的详细信息或上下文，帮助模型理解任务的背景和意图。如“Ubuntu
22.04”、“Python 3.11 和基于 requests 库”。</li>
<li><strong>输入数据</strong>
。用户输入的内容或问题，作为模型生成输出的依据，如“输入的数据是 JSON
格式”、“通过命令行参数传递输入”等。</li>
</ol>
</section>
<section id="prompt-engineering-2" class="slide level2">
<h2>六要素模型 (2/2)</h2>
<ol start="4" type="1">
<li><strong>输出指示</strong>
。指定输出的类型或格式，控制模型生成的结果的长度、结构、风格等。</li>
<li><strong>示例</strong>
。提供一些输入相关的示例或参考文本，展示期望的输出效果。</li>
<li><strong>角色</strong>
。指定模型所扮演的角色或身份，影响模型的专业知识领域、语言风格和回答方式。</li>
</ol>
</section>
<section id="和提问的智慧进行比较" class="slide level2">
<h2>和“提问的智慧”进行比较</h2>
<ol type="1">
<li>在提问或使用提示词之前，先尝试搜索已有的信息或资源，以避免重复或无效的问题。</li>
<li>清晰、准确、简洁地表达你的问题或目的，避免模糊、冗长或不相关的内容。</li>
<li>提供一些示例或上下文，以帮助理解你的问题或目的，但不要过多或过少。</li>
<li>尊重你的回答者或模型的时间和能力，不要提出过于简单或过于复杂的问题。</li>
<li>从回答或输出中学习，并对其进行验证和反馈。</li>
</ol>
</section></section>
<section>
<section id="参考文献" class="title-slide slide level1">
<h1>参考文献</h1>

</section>
<section class="slide level2">

<ul>
<li><a
href="https://help.ubuntu.com/community/EnvironmentVariables">EnvironmentVariables
from Ubuntu Official Documentation</a></li>
<li><a
href="http://blog.jobbole.com/36375/">在服务器上排除问题的头五分钟</a></li>
<li><a href="https://news.ycombinator.com/item?id=11909543">My First 10
Minutes on a Server</a></li>
<li><a
href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/master/README-zh_CN.md">提问的智慧</a></li>
<li><a
href="https://help.ubuntu.com/community/ReportingBugs">ReportingBugs
Tutorial by Ubuntu Official Documentation</a></li>
<li><a
href="https://wiki.ubuntu.com/DebuggingProcedures">DebuggingProcedures
Tutorial by Ubuntu Official Documentation</a></li>
</ul>
</section></section>
    </div>
  </div>

  <script src="reveal.js/lib/js/head.min.js"></script>
  <script src="reveal.js/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,
        // Display a presentation progress bar
        progress: true,
        // Display the page number of the current slide
        slideNumber: true,
        // Push each slide change to the browser history
        history: true,
        // Enable keyboard shortcuts for navigation
        keyboard: true,
        // Enable the slide overview mode
        overview: true,
        // Vertical centering of slides
        center: true,
        // Enables touch navigation on devices with touch input
        touch: true,
        // see https://github.com/hakimel/reveal.js/#navigation-mode
        navigationMode: 'default',
        // Turns fragments on and off globally
        fragments: true,
        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,
        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,
        // Stop auto-sliding after user input
        autoSlideStoppable: true,
        // Transition style
        transition: 'fade', // none/fade/slide/convex/concave/zoom
        // Transition speed
        transitionSpeed: 'default', // default/fast/slow
        // Transition style for full page slide backgrounds
        backgroundTransition: 'fade', // none/fade/slide/convex/concave/zoom
        // Number of slides away from the current that are visible
        viewDistance: 3,
        math: {
          mathjax: '',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

menu: {
		// Specifies which side of the presentation the menu will 
		// be shown. Use 'left' or 'right'.
		side: 'left',

		// Specifies the width of the menu.
		// Can be one of the following:
		// 'normal', 'wide', 'third', 'half', 'full', or
		// any valid css length value
		width: 'normal',

		// Add slide numbers to the titles in the slide list.
		// Use 'true' or format string (same as reveal.js slide numbers)
		numbers: false,

		// Specifies which slide elements will be used for generating
		// the slide titles in the menu. The default selects the first
		// heading element found in the slide, but you can specify any
		// valid css selector and the text from the first matching
		// element will be used.
		// Note: that a section data-menu-title attribute or an element
		// with a menu-title class will take precedence over this option
		titleSelector: 'h1, h2, h3, h4, h5, h6',

		// If slides do not have a matching title, attempt to use the
		// start of the text content as the title instead
		useTextContentForMissingTitles: false,

		// Hide slides from the menu that do not have a title.
		// Set to 'true' to only list slides with titles.
		hideMissingTitles: false,

		// Adds markers to the slide titles to indicate the 
		// progress through the presentation. Set to 'false'
		// to hide the markers.
		markers: true,

		// Specify custom panels to be included in the menu, by
		// providing an array of objects with 'title', 'icon'
		// properties, and either a 'src' or 'content' property.
		custom: false,

		// Specifies the themes that will be available in the themes
		// menu panel. Set to 'true' to show the themes menu panel
		// with the default themes list. Alternatively, provide an
		// array to specify the themes to make available in the
		// themes menu panel, for example...
		// [
		//     { name: 'Black', theme: 'css/theme/black.css' },
		//     { name: 'White', theme: 'css/theme/white.css' },
		//     { name: 'League', theme: 'css/theme/league.css' }
		// ]
		themes: false,

		// Specifies the path to the default theme files. If your
		// presentation uses a different path to the standard reveal
		// layout then you need to provide this option, but only
		// when 'themes' is set to 'true'. If you provide your own 
		// list of themes or 'themes' is set to 'false' the 
		// 'themesPath' option is ignored.
		themesPath: 'css/theme/',

		// Specifies if the transitions menu panel will be shown.
		// Set to 'true' to show the transitions menu panel with
		// the default transitions list. Alternatively, provide an
		// array to specify the transitions to make available in
		// the transitions panel, for example...
		// ['None', 'Fade', 'Slide']
		transitions: false,

		// Adds a menu button to the slides to open the menu panel.
		// Set to 'false' to hide the button.
		openButton: true,

		// If 'true' allows the slide number in the presentation to
		// open the menu panel. The reveal.js slideNumber option must 
		// be displayed for this to take effect
		openSlideNumber: false,

		// If true allows the user to open and navigate the menu using
		// the keyboard. Standard keyboard interaction with reveal
		// will be disabled while the menu is open.
		keyboard: true,

		// Normally the menu will close on user actions such as
		// selecting a menu item, or clicking the presentation area.
		// If 'true', the sticky option will leave the menu open
		// until it is explicitly closed, that is, using the close
		// button or pressing the ESC or m key (when the keyboard 
		// interaction option is enabled).
		sticky: false,

		// If 'true' standard menu items will be automatically opened
		// when navigating using the keyboard. Note: this only takes 
		// effect when both the 'keyboard' and 'sticky' options are enabled.
		autoOpen: true,

		// If 'true' the menu will not be created until it is explicitly
		// requested by calling RevealMenu.init(). Note this will delay
		// the creation of all menu panels, including custom panels, and
		// the menu button.
		delayInit: false,

		// If 'true' the menu will be shown when the menu is initialised.
		openOnInit: false,

		// By default the menu will load it's own font-awesome library
		// icons. If your presentation needs to load a different
		// font-awesome library the 'loadIcons' option can be set to false
		// and the menu will not attempt to load the font-awesome library.
		loadIcons: true
	},


        // Optional reveal.js plugins
        dependencies: [
          { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
          { src: 'reveal.js/plugin/math/math.js', async: true },
          { src: 'reveal.js/plugin/menu/menu.js'},
          { src: 'reveal.js/plugin/markdown/marked.js'},
          { src: 'reveal.js/plugin/markdown/markdown.js'},
          { src: 'reveal.js/plugin/search/search.js'},
          { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'reveal.js/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
